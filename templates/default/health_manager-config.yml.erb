---
<%
  ccdb = cloud_controller_database
%>
local_route: <%= node['cloudfoundry']['local_route'] %>
mbus: <%= cf_mbus_url %>
logging:
  file:  <%= node['cloudfoundry_health_manager']['log_file'] %>
  level: <%= node['cloudfoundry_health_manager']['log_level'] %>
pid: <%= node['cloudfoundry_health_manager']['pid_file'] %>
rails_environment: production

database_environment:
  production:
    database: <%= ccdb[:name] %>
    host: <%= ccdb[:host] %>
    port: <%= ccdb[:port] %>
    encoding: utf8
    username: <%= ccdb[:user] %>
    password: <%= ccdb[:password] %>
    timeout: 2000
    template: template0 # Required for utf8 encoding
    adapter: postgresql
intervals:
  database_scan: <%= node['cloudfoundry_health_manager']['database_scan'] %>
  droplet_lost: <%= node['cloudfoundry_health_manager']['droplet_lost'] %>
  droplets_analysis: <%= node['cloudfoundry_health_manager']['droplet_analysis'] %>
  flapping_death: <%= node['cloudfoundry_health_manager']['flapping_death'] %>
  flapping_timeout: <%= node['cloudfoundry_health_manager']['flapping_timeout'] %>
  restart_timeout: <%= node['cloudfoundry_health_manager']['restart_timeout'] %>
  stable_state: <%= node['cloudfoundry_health_manager']['stable_state'] %>
